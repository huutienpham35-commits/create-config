<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T·∫°o C·∫•u H√¨nh iOS By ùôÉùôè ùôÑùôäùôé·ØìDev</title>

<!-- Favicon -->
  <link rel="icon" href="https://sf-static.upanhlaylink.com/img/image_202512316b2ab02ddd85aaff96bb355e1701ee28.jpg" type="image/jpeg">
  <link rel="shortcut icon" href="https://sf-static.upanhlaylink.com/img/image_202512316b2ab02ddd85aaff96bb355e1701ee28.jpg" type="image/jpeg">
  <link rel="apple-touch-icon" href="https://sf-static.upanhlaylink.com/img/image_202512316b2ab02ddd85aaff96bb355e1701ee28.jpg">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        :root {
            --primary-color: #007AFF;
            --secondary-color: #5856D6;
            --card-color: rgba(255, 255, 255, 0.1);
            --text-color: rgb(255, 255, 255);
            --input-text-color: #000000;
            --border-color: rgba(255, 255, 255, 0.3);
            --radius: 15px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        
        body {
            background: url('https://i.postimg.cc/DyC944zj/IMG-0144.jpg') no-repeat center center fixed;
            background-size: cover;
            color: white;
            padding: 20px;
            min-height: 100vh;
            transition: background-image 0.5s ease;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            position: relative;
        }
        
        h1 {
            color: rgb(160, 102, 214);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            font-size: 2.2em;
        }
        
        .description {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 15px;
            font-size: 1em;
        }
        
        .card {
            background-color: var(--card-color);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: white;
            font-size: 14px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-size: 16px;
            background: #ffffff00;
            color: var(--input-text-color);
            transition: border-color 0.3s;
        }
        
        input::placeholder, textarea::placeholder {
            color: rgba(0, 0, 0, 0.6);
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.3);
        }
        
        button {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        button:hover {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
        }
        
        .preview-section {
            display: none;
        }
        
        .preview-content {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            font-size: 13px;
            color: #00ff00;
            line-height: 1.4;
        }
        
        .actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .secondary-btn {
            background: linear-gradient(135deg, rgba(108, 117, 125, 0.8), rgba(73, 80, 87, 0.8));
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .secondary-btn:hover {
            background: linear-gradient(135deg, rgba(90, 98, 104, 0.9), rgba(62, 68, 74, 0.9));
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .tabs-container {
            position: relative;
            margin-bottom: 25px;
        }
        
        .tabs-scroll {
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            padding-bottom: 5px;
        }
        
        .tabs-scroll::-webkit-scrollbar {
            display: none;
        }
        
        .tabs {
            display: inline-flex;
            background: transparent;
            border-radius: var(--radius);
            padding: 5px;
            gap: 5px;
            min-width: 100%;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            text-align: center;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            transition: all 0.3s;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            min-width: 140px;
            flex-shrink: 0;
        }
        
        .tab.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .advanced-tabs-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        .advanced-tabs-scroll {
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            padding-bottom: 5px;
        }
        
        .advanced-tabs-scroll::-webkit-scrollbar {
            display: none;
        }
        
        .advanced-tabs {
            display: inline-flex;
            background: transparent;
            border-radius: var(--radius);
            padding: 5px;
            gap: 5px;
            min-width: 100%;
        }
        
        .advanced-tab {
            padding: 10px 15px;
            cursor: pointer;
            text-align: center;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            transition: all 0.3s;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            min-width: 160px;
            flex-shrink: 0;
            font-size: 14px;
        }
        
        .advanced-tab.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .advanced-tab-content {
            display: none;
        }
        
        .advanced-tab-content.active {
            display: block;
        }
        
        .success-message {
            background: rgba(212, 237, 218, 0.9);
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
            border-left: 4px solid #28a745;
            border: 2px solid rgba(40, 167, 69, 0.5);
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .multiple-webclips-section {
            background-color: rgba(255, 248, 225, 0.1);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #FFA000;
            border: 2px solid rgba(255, 160, 0, 0.3);
        }
        
        .webclip-list {
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .webclip-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .webclip-item-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .webclip-item-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .webclip-item-info {
            flex: 1;
        }
        
        .webclip-item-name {
            font-weight: bold;
            font-size: 14px;
            color: white;
        }
        
        .webclip-item-url {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .webclip-item-actions {
            display: flex;
            gap: 5px;
        }
        
        .remove-btn {
            background: linear-gradient(135deg, #FF3B30, #D32F2F);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            padding: 6px 12px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }
        
        .remove-btn:hover {
            background: linear-gradient(135deg, #D32F2F, #B71C1C);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }
        
        .file-input-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-input-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .file-input-btn:hover {
            background-color: rgba(255, 255, 255, 0.15);
            border-color: var(--primary-color);
        }
        
        .file-name {
            margin-top: 8px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
        }

        /* N√∫t Menu */
        .menu-btn {
            position: fixed;
            top: 30px;
            left: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            font-size: 20px;
        }

        .menu-btn:hover {
            transform: scale(1.1) rotate(15deg);
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
        }

        .settings-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            font-size: 20px;
        }

        .settings-btn:hover {
            transform: scale(1.1) rotate(15deg);
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
        }

        .music-btn {
            position: fixed;
            bottom: 110px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            font-size: 22px;
        }

        .music-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
        }

        .music-btn.playing {
            background: linear-gradient(135deg, #4ECDC4, #44A08D);
            animation: pulse 1.5s infinite;
        }

        .music-btn.muted {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            opacity: 0.7;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(78, 205, 196, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(78, 205, 196, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(78, 205, 196, 0);
            }
        }

        .customization-panel {
            position: fixed;
            top: 50%;
            left: -400px;
            transform: translateY(-50%);
            width: 350px;
            background: rgba(0, 0, 0, 0.9);
            padding: 25px;
            border-radius: 0 15px 15px 0;
            z-index: 1000;
            transition: left 0.5s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--border-color);
        }

        .customization-panel.open {
            left: 0;
        }

        .toggle-panel {
            position: absolute;
            right: -45px;
            top: 20px;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0 10px 10px 0;
            cursor: pointer;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .color-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.active {
            border-color: white;
            transform: scale(1.1);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.5), 0 4px 15px rgba(0, 0, 0, 0.4);
        }

        /* Gradient cho c√°c theme */
        .theme-purple { background: linear-gradient(135deg, #8A2387, #E94057, #F27121); }
        .theme-green { background: linear-gradient(135deg, #00b09b, #96c93d); }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            z-index: 1000;
            display: none;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border: 2px solid var(--border-color);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: white;
        }

        .input-group input[type="file"],
        .input-group input[type="range"] {
            width: 100%;
        }

        .value-display {
            text-align: center;
            margin-top: 8px;
            font-weight: 600;
            color: white;
        }

        .background-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 15px 0;
        }

        .bg-option {
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.1);
        }

        .bg-option:hover {
            border-color: var(--primary-color);
            background: rgba(255, 255, 255, 0.15);
        }

        .bg-option.active {
            border-color: var(--primary-color);
            background: rgba(255, 255, 255, 0.2);
        }

        .flower {
            position: absolute;
            font-size: 20px;
            z-index: -1;
            pointer-events: none;
            opacity: 0.7;
            animation: fall linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .installation-guide {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--primary-color);
            border: 2px solid var(--border-color);
        }

        .installation-steps {
            margin-top: 15px;
        }

        .installation-step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .step-number {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .step-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .tabs {
                min-width: auto;
            }
            
            .tab {
                min-width: 120px;
                padding: 10px 15px;
            }
            
            .advanced-tabs {
                min-width: auto;
            }
            
            .advanced-tab {
                min-width: 140px;
                padding: 8px 12px;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .customization-panel {
                width: 300px;
            }
            
            .install-options {
                min-width: auto;
            }
            
            .install-option {
                min-width: 180px;
            }

            .music-btn {
                bottom: 100px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 18px;
            }
            
            .menu-btn {
                top: 20px;
                left: 20px;
                width: 50px;
                height: 50px;
            }
        }

        .create-file-btn {
            background: linear-gradient(135deg, #28a745, #218838);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px auto;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .create-file-btn:hover {
            background: linear-gradient(135deg, #218838, #1e7e34);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 255, 255, 0.8);
        }

        .create-file-btn i {
            font-size: 20px;
        }

        .simple-actions {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
            flex-wrap: wrap;
        }

        .install-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 180px;
        }

        .install-btn:hover {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.8);
        }

        .create-btn {
            background: linear-gradient(135deg, #28a745, #218838);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 180px;
        }

        .create-btn:hover {
            background: linear-gradient(135deg, #218838, #1e7e34);
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.8);
        }
        
        /* Menu Panel */
        .menu-panel {
            position: fixed;
            top: 100px;
            left: -400px;
            width: 350px;
            background: rgba(0, 0, 0, 0.9);
            padding: 25px;
            border-radius: 0 15px 15px 0;
            z-index: 1000;
            transition: left 0.5s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--border-color);
        }

        .menu-panel.open {
            left: 0;
        }

        .menu-item {
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .menu-item:hover {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            transform: translateX(5px);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .menu-item i {
            font-size: 20px;
            width: 30px;
        }

        .auto-save-info {
            position: fixed;
            top: 30px;
            right: 30px;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 12px;
            color: #4CAF50;
            display: none;
            z-index: 1000;
            border: 2px solid rgba(76, 175, 80, 0.5);
        }

        .auto-save-info.show {
            display: block;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- Auto Save Info -->
    <div class="auto-save-info" id="autoSaveInfo">
        <i class="fas fa-save"></i> ƒê√£ l∆∞u t·ª± ƒë·ªông
    </div>

    <!-- N√∫t Menu -->
    <button class="menu-btn" id="menuBtn">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Menu Panel -->
    <div class="menu-panel" id="menuPanel">
        <h3 style="color: white; margin-bottom: 20px; text-align: center;">Menu</h3>
         <a href="https://htios2590.vercel.app/" target="_blank" class="menu-item" style="text-decoration: none;">
        <i class="fas fa-bolt"></i>
        <span>Home</span>
    </a>
        <div class="menu-item" id="exportConfigBtn">
            <i class="fas fa-download"></i>
            <span>Xu·∫•t C·∫•u H√¨nh</span>
        </div>
        <div class="menu-item" id="importConfigBtn">
            <i class="fas fa-upload"></i>
            <span>Nh·∫≠p C·∫•u H√¨nh</span>
        </div>
        <div class="menu-item" id="saveDataBtn">
            <i class="fas fa-save"></i>
            <span>L∆∞u D·ªØ Li·ªáu</span>
        </div>
        <div class="menu-item" id="loadDataBtn">
            <i class="fas fa-folder-open"></i>
            <span>T·∫£i D·ªØ Li·ªáu</span>
        </div>
        <div class="menu-item" id="resetFormBtn">
            <i class="fas fa-redo"></i>
            <span>ƒê·∫∑t L·∫°i Form</span>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>T·∫°o C·∫•u H√¨nh iOS By ùôÉùôè ùôÑùôäùôé·ØìDev</h1>
            <p class="description">C√¥ng c·ª• t·∫°o file c·∫•u h√¨nh .mobileconfig cho thi·∫øt b·ªã iOS m·ªôt c√°ch d·ªÖ d√†ng</p>
        </header>
        
        <div class="tabs-container">
            <div class="tabs-scroll">
                <div class="tabs">
                    <div class="tab active" data-tab="basic">Th√¥ng Tin C∆° B·∫£n</div>
                    <div class="tab" data-tab="webclip">Web Clip</div>
                    <div class="tab" data-tab="wifi">Wi-Fi</div>
                    <div class="tab" data-tab="dns">DNS</div>
                    <div class="tab" data-tab="advanced">N√¢ng Cao</div>
                </div>
            </div>
        </div>
        
        <form id="configForm">
            <!-- Tab Th√¥ng Tin C∆° B·∫£n -->
            <div class="tab-content active" id="basic-tab">
                <div class="card">
                    <h2>Th√¥ng Tin C·∫•u H√¨nh</h2>
                    <div class="form-group">
                        <label for="configName">T√™n C·∫•u H√¨nh</label>
                        <input type="text" id="configName" placeholder="V√≠ d·ª•: C·∫•u h√¨nh c√¥ng ty" required>
                    </div>
                    <div class="form-group">
                        <label for="configDescription">M√¥ T·∫£</label>
                        <textarea id="configDescription" rows="3" placeholder="M√¥ t·∫£ v·ªÅ c·∫•u h√¨nh n√†y"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="organization">T·ªï Ch·ª©c</label>
                        <input type="text" id="organization" placeholder="T√™n c√¥ng ty/t·ªï ch·ª©c">
                    </div>
                    <div class="form-group">
                        <label for="identifier">ƒê·ªãnh Danh</label>
                        <input type="text" id="identifier" placeholder="com.company.configuration" required>
                        <small style="color: rgba(255,255,255,0.7); font-size: 12px;">ƒê·ªãnh danh duy nh·∫•t cho c·∫•u h√¨nh (th∆∞·ªùng l√† t√™n mi·ªÅn ng∆∞·ª£c)</small>
                    </div>
                    <div class="form-group">
                        <label for="removalDisallowed">Kh√¥ng Cho Ph√©p G·ª° B·ªè</label>
                        <select id="removalDisallowed">
                            <option value="false">Cho ph√©p g·ª° b·ªè</option>
                            <option value="true">Kh√¥ng cho ph√©p g·ª° b·ªè</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Tab C·∫•u H√¨nh Wi-Fi -->
            <div class="tab-content" id="wifi-tab">
                <div class="card">
                    <h2>C·∫•u H√¨nh Wi-Fi</h2>
                    <div class="form-group">
                        <label for="wifiSSID">SSID (T√™n M·∫°ng)</label>
                        <input type="text" id="wifiSSID" placeholder="T√™n m·∫°ng Wi-Fi">
                    </div>
                    <div class="form-group">
                        <label for="wifiSecurity">B·∫£o M·∫≠t</label>
                        <select id="wifiSecurity">
                            <option value="None">Kh√¥ng</option>
                            <option value="WEP">WEP</option>
                            <option value="WPA">WPA/WPA2</option>
                            <option value="WPA2">WPA2 Enterprise</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="wifiPassword">M·∫≠t Kh·∫©u</label>
                        <input type="password" id="wifiPassword" placeholder="M·∫≠t kh·∫©u Wi-Fi">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="wifiAutoJoin">T·ª± ƒê·ªông K·∫øt N·ªëi</label>
                            <select id="wifiAutoJoin">
                                <option value="true">C√≥</option>
                                <option value="false">Kh√¥ng</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="wifiHidden">M·∫°ng ·∫®n</label>
                            <select id="wifiHidden">
                                <option value="false">Kh√¥ng</option>
                                <option value="true">C√≥</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab C·∫•u H√¨nh DNS -->
            <div class="tab-content" id="dns-tab">
                <div class="card">
                    <h2>C·∫•u H√¨nh DNS</h2>
                    <div class="form-group">
                        <label for="dnsProxy">Proxy DNS</label>
                            <select id="dnsProxy">
                            <option value="false">Kh√¥ng s·ª≠ d·ª•ng</option>
                            <option value="true">S·ª≠ d·ª•ng proxy DNS</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dnsServers">M√°y Ch·ªß DNS</label>
                        <textarea id="dnsServers" rows="3" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ DNS, m·ªói ƒë·ªãa ch·ªâ tr√™n m·ªôt d√≤ng (v√≠ d·ª•: 8.8.8.8, 1.1.1.1)"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="dnsSearchDomains">T√™n Mi·ªÅn T√¨m Ki·∫øm</label>
                        <textarea id="dnsSearchDomains" rows="2" placeholder="Nh·∫≠p t√™n mi·ªÅn t√¨m ki·∫øm, m·ªói t√™n mi·ªÅn tr√™n m·ªôt d√≤ng"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- Tab Web Clip -->
            <div class="tab-content" id="webclip-tab">
                <div class="card">
                    <h2>Web Clip</h2>

                    <!-- PH·∫¶N T·∫†O NHI·ªÄU WEBCLIP -->
                    <div class="multiple-webclips-section">
                        <h3><i class="fas fa-layer-group"></i> T·∫°o Nhi·ªÅu Web Clip</h3>
                        <div class="form-group">
                            <label for="multipleWebclipCount">S·ªë l∆∞·ª£ng Web Clip c·∫ßn t·∫°o</label>
                            <input type="number" id="multipleWebclipCount" min="1" max="5000" value="1" placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng">
                        </div>
                        <div class="form-group">
                            <label for="multipleWebclipBaseName">T√™n c∆° b·∫£n</label>
                            <input type="text" id="multipleWebclipBaseName" placeholder="V√≠ d·ª•: ·ª®ng d·ª•ng">
                        </div>
                        <div class="form-group">
                            <label for="multipleWebclipBaseURL">URL c∆° b·∫£n</label>
                            <input type="text" id="multipleWebclipBaseURL" placeholder="V√≠ d·ª•: https://app.com/app">
                        </div>
                        
                        <div class="form-group">
                            <label for="webclipFullScreen">Ch·∫ø ƒë·ªô to√†n m√†n h√¨nh</label>
                            <select id="webclipFullScreen">
                                <option value="true">C√≥</option>
                                <option value="false" selected>Kh√¥ng</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="webclipIconFile">Bi·ªÉu T∆∞·ª£ng Web Clip</label>
                            <div class="file-input-wrapper">
                                <div class="file-input-btn">
                                    <i class="fas fa-image"></i> Ch·ªçn ·∫£nh bi·ªÉu t∆∞·ª£ng
                                </div>
                                <input type="file" id="webclipIconFile" accept="image/*">
                            </div>
                            <div class="file-name" id="webclipIconFileName">Ch∆∞a ch·ªçn ·∫£nh</div>
                        </div>
                        <button type="button" class="auto-generate-btn" id="generateMultipleWebclipsBtn">T·∫°o Nhi·ªÅu Web Clip</button>
                    </div>

                    <!-- DANH S√ÅCH WEBCLIP ƒê√É T·∫†O -->
                    <div class="webclips-summary-section" style="background-color: rgba(232, 245, 233, 0.1); border-radius: 8px; padding: 20px; margin-top: 20px; border-left: 4px solid #4CAF50; border: 2px solid rgba(76, 175, 80, 0.3);">
                        <h3><i class="fas fa-list"></i> Danh S√°ch Web Clip ƒê√£ T·∫°o</h3>
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 15px; font-size: 14px;">
                            T·ªïng s·ªë: <span id="totalWebclipsCount">0</span> web clip
                        </div>
                        <div class="webclip-list" id="multipleWebclipsList" style="max-height: 400px;">
                            <!-- Empty State -->
                            <div class="empty-state" id="webclipEmptyState" style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.6);">
                                <i class="fas fa-inbox" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
                                <p style="margin: 0 0 8px 0; font-size: 1.1em;">Ch∆∞a c√≥ web clip n√†o ƒë∆∞·ª£c t·∫°o</p>
                                <small style="font-size: 0.9em;">H√£y th√™m web clip t·ª´ c√°c ph·∫ßn b√™n tr√™n</small>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px;">
                            <button type="button" id="clearAllWebclipsBtn" class="remove-btn" style="background: linear-gradient(135deg, #f44336, #d32f2f);">
                                <i class="fas fa-trash"></i> X√≥a T·∫•t C·∫£
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab N√¢ng Cao -->
            <div class="tab-content" id="advanced-tab">
                <div class="advanced-tabs-container">
                    <div class="advanced-tabs-scroll">
                        <div class="advanced-tabs">
                            <div class="advanced-tab active" data-advanced-tab="network">C·∫•u H√¨nh M·∫°ng</div>
                            <div class="advanced-tab" data-advanced-tab="storage">Thi·∫øt L·∫≠p Dung L∆∞·ª£ng</div>
                            <div class="advanced-tab" data-advanced-tab="notification">Thi·∫øt L·∫≠p Th√¥ng B√°o</div>
                            <div class="advanced-tab" data-advanced-tab="custom">D·ªØ Li·ªáu T√πy Ch·ªânh</div>
                        </div>
                    </div>
                </div>
                
                <div class="advanced-tab-content active" id="network-tab">
                    <div class="card">
                        <h2>C·∫•u H√¨nh M·∫°ng</h2>
                        <div class="form-group">
                            <label for="apnName">T√™n APN</label>
                            <input type="text" id="apnName" placeholder="T√™n ƒëi·ªÉm truy c·∫≠p">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="apnUsername">T√™n ƒêƒÉng Nh·∫≠p APN</label>
                                <input type="text" id="apnUsername" placeholder="T√™n ƒëƒÉng nh·∫≠p APN">
                            </div>
                            <div class="form-group">
                                <label for="apnPassword">M·∫≠t Kh·∫©u APN</label>
                                <input type="password" id="apnPassword" placeholder="M·∫≠t kh·∫©u APN">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="apnProxy">Proxy</label>
                                <input type="text" id="apnProxy" placeholder="proxy.example.com:8080">
                            </div>
                            <div class="form-group">
                                <label for="apnProxyPort">C·ªïng Proxy</label>
                                <input type="number" id="apnProxyPort" placeholder="8080">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="advanced-tab-content" id="storage-tab">
                    <div class="card">
                        <h2>Thi·∫øt L·∫≠p Dung L∆∞·ª£ng</h2>
                        <div class="form-group">
                            <label for="fakeStorageEnabled">K√≠ch Ho·∫°t Dung L∆∞·ª£ng Gi·∫£</label>
                            <select id="fakeStorageEnabled">
                                <option value="false">Kh√¥ng</option>
                                <option value="true">C√≥</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="fakeTotalCapacity">T·ªïng Dung L∆∞·ª£ng (GB)</label>
                                <input type="number" id="fakeTotalCapacity" placeholder="128" min="1" max="1024">
                            </div>
                            <div class="form-group">
                                <label for="fakeAvailableCapacity">Dung L∆∞·ª£ng Tr·ªëng (GB)</label>
                                <input type="number" id="fakeAvailableCapacity" placeholder="64" min="1" max="1024">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="advanced-tab-content" id="notification-tab">
                    <div class="card">
                        <h2>Thi·∫øt L·∫≠p Th√¥ng B√°o</h2>
                        <div class="form-group">
                            <label for="notificationTitle">Ti√™u ƒê·ªÅ Th√¥ng B√°o</label>
                            <input type="text" id="notificationTitle" placeholder="Ti√™u ƒë·ªÅ th√¥ng b√°o">
                        </div>
                        <div class="form-group">
                            <label for="notificationBody">N·ªôi Dung Th√¥ng B√°o</label>
                            <textarea id="notificationBody" rows="4" placeholder="N·ªôi dung th√¥ng b√°o"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="notificationAction">H√†nh ƒê·ªông</label>
                                <input type="text" id="notificationAction" placeholder="H√†nh ƒë·ªông (t√πy ch·ªçn)">
                            </div>
                            <div class="form-group">
                                <label for="notificationSound">√Çm Thanh</label>
                                <select id="notificationSound">
                                    <option value="">M·∫∑c ƒë·ªãnh</option>
                                    <option value="chime">Chime</option>
                                    <option value="alert">Alert</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="advanced-tab-content" id="custom-tab">
                    <div class="card">
                        <h2>D·ªØ Li·ªáu T√πy Ch·ªânh</h2>
                        <div class="form-group">
                            <label for="customPayloadType">Lo·∫°i Payload T√πy Ch·ªânh</label>
                            <input type="text" id="customPayloadType" placeholder="com.company.custom">
                        </div>
                        <div class="form-group">
                            <label for="customPayloadData">D·ªØ Li·ªáu T√πy Ch·ªânh (XML/JSON)</label>
                            <textarea id="customPayloadData" rows="6" placeholder='<key>CustomKey</key>
<string>CustomValue</string>'></textarea>
                        </div>
                        <div class="form-group">
                            <label for="customPayloadDescription">M√¥ T·∫£ Payload T√πy Ch·ªânh</label>
                            <input type="text" id="customPayloadDescription" placeholder="M√¥ t·∫£ payload t√πy ch·ªânh">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="actions">
                <button type="button" id="generateBtn">T·∫°o C·∫•u H√¨nh</button>
            </div>
        </form>
        
        <div class="preview-section card" id="previewSection">
            <h2>Xem Tr∆∞·ªõc C·∫•u H√¨nh</h2>
            <div class="preview-content" id="previewContent"></div>
            
            <div class="simple-actions">
                <button type="button" id="installBtn" class="install-btn">
                    <i class="fas fa-mobile-alt"></i> C√†i ƒê·∫∑t Ngay
                </button>
                <button type="button" id="createBtn" class="create-btn">
                    <i class="fas fa-file-download"></i> T·∫°o File ZIP
                </button>
            </div>
            
            <!-- Installation Guide -->
            <div class="installation-guide" id="installationGuide">
                <h3>H∆∞·ªõng D·∫´n C√†i ƒê·∫∑t</h3>
                <div class="installation-steps">
                    <div class="installation-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">T·∫£i file c·∫•u h√¨nh</div>
                            <div class="step-description">Nh·∫•n n√∫t "T·∫°o File ZIP" ƒë·ªÉ t·∫£i file c·∫•u h√¨nh v·ªÅ thi·∫øt b·ªã c·ªßa b·∫°n</div>
                        </div>
                    </div>
                    <div class="installation-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">M·ªü file tr√™n iOS</div>
                            <div class="step-description">Truy c·∫≠p v√†o Files app ho·∫∑c Safari Downloads v√† nh·∫•n v√†o file v·ª´a t·∫£i</div>
                        </div>
                    </div>
                    <div class="installation-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">C√†i ƒë·∫∑t c·∫•u h√¨nh</div>
                            <div class="step-description">L√†m theo h∆∞·ªõng d·∫´n tr√™n m√†n h√¨nh ƒë·ªÉ c√†i ƒë·∫∑t c·∫•u h√¨nh v√†o thi·∫øt b·ªã</div>
                        </div>
                    </div>
                    <div class="installation-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">X√°c nh·∫≠n c√†i ƒë·∫∑t</div>
                            <div class="step-description">V√†o Settings ‚Üí General ‚Üí VPN & Device Management ƒë·ªÉ x√°c nh·∫≠n c·∫•u h√¨nh ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="actions">
                <button type="button" id="closePreviewBtn" class="secondary-btn">ƒê√≥ng</button>
            </div>
        </div>
        
        <div class="success-message" id="successMessage">
            C·∫•u h√¨nh ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng! Ch·ªçn ph∆∞∆°ng th·ª©c c√†i ƒë·∫∑t ph√π h·ª£p.
        </div>
    </div>

    <!-- Settings Button -->
    <button class="settings-btn" id="settingsBtn">
        <i class="fas fa-cog"></i>
    </button>

    <!-- Customization Panel -->
    <div class="customization-panel" id="customizationPanel">
        <button class="toggle-panel" id="togglePanel">
            <i class="fas fa-times"></i>
        </button>
        <h3>T√πy ch·ªânh giao di·ªán</h3>
        
        <div class="input-group">
            <label>Ch·ªçn ·∫£nh n·ªÅn:</label>
            <div class="background-options">
                <div class="bg-option active" data-bg="https://i.postimg.cc/DyC944zj/IMG-0144.jpg">N·ªÅn m·∫∑c ƒë·ªãnh</div>
                <div class="file-input-wrapper">
                    <div class="file-input-btn">
                        <i class="fas fa-upload"></i> T·∫£i ·∫£nh t·ª´ m√°y
                    </div>
                    <input type="file" id="customBgUpload" accept="image/*">
                </div>
                <div class="file-name" id="customBgFileName">Ch∆∞a ch·ªçn ·∫£nh</div>
            </div>
        </div>
        
        <div class="color-options">
            <div class="color-option theme-purple" data-theme="purple"></div>
    <div class="color-option theme-green active" data-theme="green"></div>
</div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
// Bi·∫øn l∆∞u tr·ªØ web clips
let webClips = [];
let currentIconBase64 = null;
let singleWebclipIconBase64 = null;

// Audio elements
const clickSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3');
const successSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-game-level-completed-2059.mp3');

// Th√™m nh·∫°c n·ªÅn
const backgroundMusic = new Audio('https://assets.mixkit.co/music/preview/mixkit-tech-house-vibes-130.mp3');
backgroundMusic.loop = true;
backgroundMusic.volume = 0.3;

// State variables for customization
let soundEnabled = localStorage.getItem('soundEnabled') !== 'false';
let volumeLevel = localStorage.getItem('volumeLevel') ? parseInt(localStorage.getItem('volumeLevel')) : 80;
let musicEnabled = localStorage.getItem('musicEnabled') !== 'false';

// Flower effect
function createFlowerEffect() {
    const flower = document.createElement('div');
    flower.className = 'flower';
    flower.innerHTML = '';
    flower.style.left = Math.random() * 100 + 'vw';
    flower.style.fontSize = (Math.random() * 20 + 15) + 'px';
    flower.style.animationDuration = (Math.random() * 5 + 5) + 's';
    document.body.appendChild(flower);
    
    setTimeout(() => {
        flower.remove();
    }, 10000);
}

// Helper functions
function generateUUID() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        const r = Math.random() * 16 | 0;
        const v = c == 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
    });
}

function showToast(message, isSuccess = true) {
    const toast = document.getElementById('toast');
    if (toast) {
        toast.textContent = message;
        toast.style.background = isSuccess ? 'rgba(76, 175, 80, 0.9)' : 'rgba(244, 67, 54, 0.9)';
        toast.style.display = 'block';
        setTimeout(() => {
            toast.style.display = 'none';
        }, 5000);
    }
}

function showAutoSaveInfo() {
    const autoSaveInfo = document.getElementById('autoSaveInfo');
    if (autoSaveInfo) {
        autoSaveInfo.classList.add('show');
        setTimeout(() => {
            autoSaveInfo.classList.remove('show');
        }, 2000);
    }
}

function updateWebclipsCount() {
    const countElement = document.getElementById('totalWebclipsCount');
    if (countElement) {
        countElement.textContent = webClips.length;
    }
}

function addWebclipToList(webclip) {
    const list = document.getElementById('multipleWebclipsList');
    if (!list) return;
    
    const emptyState = document.getElementById('webclipEmptyState');
    if (emptyState) {
        emptyState.remove();
    }
    
    const item = document.createElement('div');
    item.className = 'webclip-item';
    item.id = `webclip-${webclip.id}`;
    
    item.innerHTML = `
        <div class="webclip-item-icon">
            ${webclip.icon ? `<img src="${webclip.icon}" alt="${webclip.name}">` : `<div style="width:100%;height:100%;background:linear-gradient(135deg, var(--primary-color), var(--secondary-color));display:flex;align-items:center;justify-content:center;color:white;font-weight:bold">${webclip.name.charAt(0)}</div>`}
        </div>
        <div class="webclip-item-info">
            <div class="webclip-item-name">${webclip.name}</div>
            <div class="webclip-item-url">${webclip.url}</div>
            <div class="webclip-item-fullscreen" style="font-size: 12px; color: ${webclip.fullScreen ? '#4CAF50' : '#FF9800'}; margin-top: 5px;">
                ${webclip.fullScreen ? '‚úì To√†n m√†n h√¨nh' : '‚úó B√¨nh th∆∞·ªùng'}
            </div>
        </div>
        <div class="webclip-item-actions">
            <button class="remove-btn" onclick="removeWebclip('${webclip.id}')">X√≥a</button>
        </div>
    `;
    
    list.appendChild(item);
}

function removeWebclip(id) {
    webClips = webClips.filter(webclip => webclip.id !== id);
    const element = document.getElementById(`webclip-${id}`);
    if (element) {
        element.remove();
    }
    
    if (webClips.length === 0) {
        const list = document.getElementById('multipleWebclipsList');
        if (list) {
            list.innerHTML = `
                <div class="empty-state" id="webclipEmptyState" style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.6);">
                    <i class="fas fa-inbox" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
                    <p style="margin: 0 0 8px 0; font-size: 1.1em;">Ch∆∞a c√≥ web clip n√†o ƒë∆∞·ª£c t·∫°o</p>
                    <small style="font-size: 0.9em;">H√£y th√™m web clip t·ª´ c√°c ph·∫ßn b√™n tr√™n</small>
                </div>
            `;
        }
    }
    
    updateWebclipsCount();
    showToast('ƒê√£ x√≥a Web Clip', true);
    saveAllData(); // L∆∞u sau khi x√≥a
}

function clearAllWebclips() {
    if (webClips.length === 0) {
        showToast('Kh√¥ng c√≥ webclip n√†o ƒë·ªÉ x√≥a', false);
        return;
    }
    
    if (confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ ${webClips.length} web clip?`)) {
        webClips = [];
        const list = document.getElementById('multipleWebclipsList');
        if (list) {
            list.innerHTML = `
                <div class="empty-state" id="webclipEmptyState" style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.6);">
                    <i class="fas fa-inbox" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
                    <p style="margin: 0 0 8px 0; font-size: 1.1em;">Ch∆∞a c√≥ web clip n√†o ƒë∆∞·ª£c t·∫°o</p>
                    <small style="font-size: 0.9em;">H√£y th√™m web clip t·ª´ c√°c ph·∫ßn b√™n tr√™n</small>
                </div>
            `;
        }
        updateWebclipsCount();
        showToast('ƒê√£ x√≥a t·∫•t c·∫£ web clip', true);
        saveAllData(); // L∆∞u sau khi x√≥a t·∫•t c·∫£
    }
}

function handleIconFileSelect(event, fileNameElementId) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            currentIconBase64 = e.target.result;
            const fileNameElement = document.getElementById(fileNameElementId);
            if (fileNameElement) {
                fileNameElement.textContent = file.name;
            }
        };
        reader.readAsDataURL(file);
    }
}

function handleSingleIconFileSelect(event, fileNameElementId) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            singleWebclipIconBase64 = e.target.result;
            const fileNameElement = document.getElementById(fileNameElementId);
            if (fileNameElement) {
                fileNameElement.textContent = file.name;
            }
        };
        reader.readAsDataURL(file);
    }
}

function addSingleWebclip() {
    const name = document.getElementById('singleWebclipName')?.value;
    const url = document.getElementById('singleWebclipURL')?.value;
    const fullScreen = document.getElementById('singleWebclipFullScreen')?.value === 'true';
    
    if (!name || !url) {
        showToast('Vui l√≤ng ƒëi·ªÅn t√™n v√† URL cho webclip', false);
        return;
    }
    
    const webclip = {
        id: generateUUID(),
        name: name,
        url: url,
        icon: singleWebclipIconBase64,
        fullScreen: fullScreen
    };
    
    webClips.push(webclip);
    addWebclipToList(webclip);
    updateWebclipsCount();
    
    const nameInput = document.getElementById('singleWebclipName');
    const urlInput = document.getElementById('singleWebclipURL');
    const fullScreenSelect = document.getElementById('singleWebclipFullScreen');
    const fileNameElement = document.getElementById('singleWebclipIconFileName');
    
    if (nameInput) nameInput.value = '';
    if (urlInput) urlInput.value = '';
    if (fullScreenSelect) fullScreenSelect.value = 'false';
    if (fileNameElement) fileNameElement.textContent = 'Ch∆∞a ch·ªçn ·∫£nh';
    
    singleWebclipIconBase64 = null;
    
    showToast(`ƒê√£ th√™m webclip "${name}" th√†nh c√¥ng!`, true);
    saveAllData(); // L∆∞u sau khi th√™m
}

function generateMultipleWebclips() {
    const countInput = document.getElementById('multipleWebclipCount');
    const baseNameInput = document.getElementById('multipleWebclipBaseName');
    const baseURLInput = document.getElementById('multipleWebclipBaseURL');
    const fullScreenSelect = document.getElementById('webclipFullScreen');
    
    if (!countInput || !baseNameInput || !baseURLInput || !fullScreenSelect) {
        showToast('Kh√¥ng t√¨m th·∫•y c√°c tr∆∞·ªùng c·∫ßn thi·∫øt', false);
        return;
    }
    
    const count = parseInt(countInput.value) || 1;
    const baseName = baseNameInput.value || '·ª®ng d·ª•ng';
    const baseURL = baseURLInput.value || 'https://example.com/app';
    const fullScreen = fullScreenSelect.value === 'true';
    
    if (count < 1 || count > 8000) {
        showToast('S·ªë l∆∞·ª£ng Web Clip ph·∫£i t·ª´ 1 ƒë·∫øn 8000', false);
        return;
    }
    
    webClips = [];
    const list = document.getElementById('multipleWebclipsList');
    if (list) {
        list.innerHTML = '';
    }
    
    for (let i = 1; i <= count; i++) {
        const webclip = {
            id: generateUUID(),
            name: baseName,
            url: baseURL,
            icon: currentIconBase64,
            fullScreen: fullScreen
        };
        
        webClips.push(webclip);
        addWebclipToList(webclip);
    }
    
    updateWebclipsCount();
    showToast(`ƒê√£ t·∫°o ${count} Web Clip th√†nh c√¥ng! T·∫•t c·∫£ ƒë·ªÅu c√≥ c√πng t√™n v√† URL. ${fullScreen ? '(To√†n m√†n h√¨nh)' : ''}`, true);
    saveAllData(); // L∆∞u sau khi t·∫°o nhi·ªÅu webclip
}

// Music control functions
function toggleMusic() {
    const musicBtn = document.getElementById('musicBtn');
    
    if (musicEnabled) {
        backgroundMusic.pause();
        musicBtn.classList.remove('playing');
        musicBtn.classList.add('muted');
        musicBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
        musicEnabled = false;
        localStorage.setItem('musicEnabled', 'false');
        showToast('ƒê√£ t·∫Øt nh·∫°c n·ªÅn', true);
    } else {
        backgroundMusic.play().catch(e => {
            console.log("Nh·∫°c kh√¥ng th·ªÉ ph√°t:", e);
            showToast('Kh√¥ng th·ªÉ ph√°t nh·∫°c. Vui l√≤ng t∆∞∆°ng t√°c v·ªõi trang tr∆∞·ªõc.', false);
        });
        musicBtn.classList.remove('muted');
        musicBtn.classList.add('playing');
        musicBtn.innerHTML = '<i class="fas fa-music"></i>';
        musicEnabled = true;
        localStorage.setItem('musicEnabled', 'true');
        showToast('ƒê√£ b·∫≠t nh·∫°c n·ªÅn', true);
    }
    saveAllData(); // L∆∞u c√†i ƒë·∫∑t √¢m nh·∫°c
}

function updateMusicVolume() {
    backgroundMusic.volume = volumeLevel / 100 * 0.3;
}

// Make functions globally available
window.removeWebclip = removeWebclip;
window.generateUUID = generateUUID;

// Start flower effect
setInterval(createFlowerEffect, 500);

// Play sound function
function playSound(sound) {
    if (!soundEnabled) return;
    
    sound.currentTime = 0;
    sound.volume = volumeLevel / 100;
    sound.play().catch(e => console.log("Audio play failed:", e));
}

// Update volume for all sounds
function updateVolume() {
    clickSound.volume = volumeLevel / 100;
    successSound.volume = volumeLevel / 100;
    updateMusicVolume();
}

// Customization functions
function initCustomization() {
    const colorOptions = document.querySelectorAll('.color-option');
    const musicBtn = document.getElementById('musicBtn');
    
    if (musicBtn) {
        if (musicEnabled) {
            backgroundMusic.play().catch(e => {
                console.log("Nh·∫°c kh√¥ng th·ªÉ t·ª± ƒë·ªông ph√°t:", e);
            });
            musicBtn.classList.add('playing');
            musicBtn.innerHTML = '<i class="fas fa-music"></i>';
        } else {
            musicBtn.classList.add('muted');
            musicBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
        }
    }
    
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme && colorOptions.length > 0) {
        const themeName = getThemeName(savedTheme);
        setThemeGradient(themeName);
        
        colorOptions.forEach(option => {
            option.classList.remove('active');
        });
        
        const activeTheme = document.querySelector(`.theme-${themeName}`);
        if (activeTheme) {
            activeTheme.classList.add('active');
        }
    }

    const customBg = localStorage.getItem('customBackgroundImage');
    if (customBg) {
        document.body.style.backgroundImage = `url('${customBg}')`;
        const fileNameElement = document.getElementById('customBgFileName');
        if (fileNameElement) {
            fileNameElement.textContent = '·∫¢nh t√πy ch·ªânh';
        }
        
        const bgOptions = document.querySelectorAll('.bg-option');
        bgOptions.forEach(option => {
            option.classList.remove('active');
        });
    }
}

function getThemeName(themeColors) {
    if (themeColors.includes('00b09b')) return 'green';
    if (themeColors.includes('8A2387')) return 'purple';
    return 'purple';
}

function setThemeGradient(themeName) {
    switch(themeName) {
        case 'green':
            document.documentElement.style.setProperty('--primary-color', '#00b09b');
            document.documentElement.style.setProperty('--secondary-color', '#96c93d');
            break;
        case 'purple':
            document.documentElement.style.setProperty('--primary-color', '#8A2387');
            document.documentElement.style.setProperty('--secondary-color', '#F27121');
            break;
        default:
            document.documentElement.style.setProperty('--primary-color', '#3498db');
            document.documentElement.style.setProperty('--secondary-color', '#2c3e50');
    }
}

// ==================== L∆ØU V√Ä T·∫¢I D·ªÆ LI·ªÜU ====================
function saveAllData() {
    try {
        const data = {
            // L∆∞u t·∫•t c·∫£ c√°c tr∆∞·ªùng input
            configName: document.getElementById('configName').value,
            configDescription: document.getElementById('configDescription').value,
            organization: document.getElementById('organization').value,
            identifier: document.getElementById('identifier').value,
            removalDisallowed: document.getElementById('removalDisallowed').value,
            
            wifiSSID: document.getElementById('wifiSSID').value,
            wifiSecurity: document.getElementById('wifiSecurity').value,
            wifiPassword: document.getElementById('wifiPassword').value,
            wifiAutoJoin: document.getElementById('wifiAutoJoin').value,
            wifiHidden: document.getElementById('wifiHidden').value,
            
            dnsProxy: document.getElementById('dnsProxy').value,
            dnsServers: document.getElementById('dnsServers').value,
            dnsSearchDomains: document.getElementById('dnsSearchDomains').value,
            
            // Webclip settings
            multipleWebclipCount: document.getElementById('multipleWebclipCount').value,
            multipleWebclipBaseName: document.getElementById('multipleWebclipBaseName').value,
            multipleWebclipBaseURL: document.getElementById('multipleWebclipBaseURL').value,
            webclipFullScreen: document.getElementById('webclipFullScreen').value,
            
            // Advanced settings
            apnName: document.getElementById('apnName').value,
            apnUsername: document.getElementById('apnUsername').value,
            apnPassword: document.getElementById('apnPassword').value,
            apnProxy: document.getElementById('apnProxy').value,
            apnProxyPort: document.getElementById('apnProxyPort').value,
            
            fakeStorageEnabled: document.getElementById('fakeStorageEnabled').value,
            fakeTotalCapacity: document.getElementById('fakeTotalCapacity').value,
            fakeAvailableCapacity: document.getElementById('fakeAvailableCapacity').value,
            
            notificationTitle: document.getElementById('notificationTitle').value,
            notificationBody: document.getElementById('notificationBody').value,
            notificationAction: document.getElementById('notificationAction').value,
            notificationSound: document.getElementById('notificationSound').value,
            
            customPayloadType: document.getElementById('customPayloadType').value,
            customPayloadData: document.getElementById('customPayloadData').value,
            customPayloadDescription: document.getElementById('customPayloadDescription').value,
            
            // L∆∞u danh s√°ch webclips
            webClips: webClips.map(webclip => ({
                id: webclip.id,
                name: webclip.name,
                url: webclip.url,
                icon: webclip.icon,
                fullScreen: webclip.fullScreen
            })),
            
            // L∆∞u c√†i ƒë·∫∑t
            soundEnabled: soundEnabled,
            volumeLevel: volumeLevel,
            musicEnabled: musicEnabled,
            
            // L∆∞u giao di·ªán
            theme: localStorage.getItem('theme'),
            backgroundImage: localStorage.getItem('backgroundImage'),
            customBackgroundImage: localStorage.getItem('customBackgroundImage')
        };
        
        localStorage.setItem('iosConfigData', JSON.stringify(data));
        showAutoSaveInfo();
        return true;
    } catch (error) {
        console.error('L·ªói khi l∆∞u d·ªØ li·ªáu:', error);
        showToast('L·ªói khi l∆∞u d·ªØ li·ªáu', false);
        return false;
    }
}

function loadAllData() {
    try {
        const savedData = localStorage.getItem('iosConfigData');
        if (!savedData) {
            showToast('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë√£ l∆∞u', false);
            return false;
        }
        
        const data = JSON.parse(savedData);
        
        // Kh√¥i ph·ª•c c√°c tr∆∞·ªùng input
        document.getElementById('configName').value = data.configName || '';
        document.getElementById('configDescription').value = data.configDescription || '';
        document.getElementById('organization').value = data.organization || '';
        document.getElementById('identifier').value = data.identifier || '';
        document.getElementById('removalDisallowed').value = data.removalDisallowed || 'false';
        
        document.getElementById('wifiSSID').value = data.wifiSSID || '';
        document.getElementById('wifiSecurity').value = data.wifiSecurity || 'None';
        document.getElementById('wifiPassword').value = data.wifiPassword || '';
        document.getElementById('wifiAutoJoin').value = data.wifiAutoJoin || 'true';
        document.getElementById('wifiHidden').value = data.wifiHidden || 'false';
        
        document.getElementById('dnsProxy').value = data.dnsProxy || 'false';
        document.getElementById('dnsServers').value = data.dnsServers || '';
        document.getElementById('dnsSearchDomains').value = data.dnsSearchDomains || '';
        
        // Kh√¥i ph·ª•c webclip settings
        document.getElementById('multipleWebclipCount').value = data.multipleWebclipCount || '1';
        document.getElementById('multipleWebclipBaseName').value = data.multipleWebclipBaseName || '';
        document.getElementById('multipleWebclipBaseURL').value = data.multipleWebclipBaseURL || '';
        document.getElementById('webclipFullScreen').value = data.webclipFullScreen || 'false';
        
        // Kh√¥i ph·ª•c advanced settings
        document.getElementById('apnName').value = data.apnName || '';
        document.getElementById('apnUsername').value = data.apnUsername || '';
        document.getElementById('apnPassword').value = data.apnPassword || '';
        document.getElementById('apnProxy').value = data.apnProxy || '';
        document.getElementById('apnProxyPort').value = data.apnProxyPort || '';
        
        document.getElementById('fakeStorageEnabled').value = data.fakeStorageEnabled || 'false';
        document.getElementById('fakeTotalCapacity').value = data.fakeTotalCapacity || '';
        document.getElementById('fakeAvailableCapacity').value = data.fakeAvailableCapacity || '';
        
        document.getElementById('notificationTitle').value = data.notificationTitle || '';
        document.getElementById('notificationBody').value = data.notificationBody || '';
        document.getElementById('notificationAction').value = data.notificationAction || '';
        document.getElementById('notificationSound').value = data.notificationSound || '';
        
        document.getElementById('customPayloadType').value = data.customPayloadType || '';
        document.getElementById('customPayloadData').value = data.customPayloadData || '';
        document.getElementById('customPayloadDescription').value = data.customPayloadDescription || '';
        
        // Kh√¥i ph·ª•c danh s√°ch webclips
        webClips = data.webClips || [];
        const list = document.getElementById('multipleWebclipsList');
        if (list) {
            list.innerHTML = '';
            if (webClips.length > 0) {
                webClips.forEach(webclip => {
                    addWebclipToList(webclip);
                });
            } else {
                list.innerHTML = `
                    <div class="empty-state" id="webclipEmptyState" style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.6);">
                        <i class="fas fa-inbox" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p style="margin: 0 0 8px 0; font-size: 1.1em;">Ch∆∞a c√≥ web clip n√†o ƒë∆∞·ª£c t·∫°o</p>
                        <small style="font-size: 0.9em;">H√£y th√™m web clip t·ª´ c√°c ph·∫ßn b√™n tr√™n</small>
                    </div>
                `;
            }
        }
        updateWebclipsCount();
        
        // Kh√¥i ph·ª•c c√†i ƒë·∫∑t
        soundEnabled = data.soundEnabled !== false;
        volumeLevel = data.volumeLevel || 80;
        musicEnabled = data.musicEnabled !== false;
        
        // Kh√¥i ph·ª•c giao di·ªán
        if (data.theme) {
            localStorage.setItem('theme', data.theme);
            setThemeGradient(data.theme);
        }
        
        if (data.customBackgroundImage) {
            localStorage.setItem('customBackgroundImage', data.customBackgroundImage);
            document.body.style.backgroundImage = `url('${data.customBackgroundImage}')`;
        } else if (data.backgroundImage) {
            localStorage.setItem('backgroundImage', data.backgroundImage);
            document.body.style.backgroundImage = `url('${data.backgroundImage}')`;
        }
        
        // Kh·ªüi t·∫°o l·∫°i √¢m nh·∫°c
        const musicBtn = document.getElementById('musicBtn');
        if (musicBtn) {
            if (musicEnabled) {
                backgroundMusic.play().catch(e => console.log("Nh·∫°c kh√¥ng th·ªÉ ph√°t:", e));
                musicBtn.classList.remove('muted');
                musicBtn.classList.add('playing');
                musicBtn.innerHTML = '<i class="fas fa-music"></i>';
            } else {
                musicBtn.classList.remove('playing');
                musicBtn.classList.add('muted');
                musicBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
            }
        }
        
        updateVolume();
        initCustomization();
        
        showToast('ƒê√£ t·∫£i d·ªØ li·ªáu th√†nh c√¥ng!', true);
        return true;
    } catch (error) {
        console.error('L·ªói khi t·∫£i d·ªØ li·ªáu:', error);
        showToast('L·ªói khi t·∫£i d·ªØ li·ªáu', false);
        return false;
    }
}

function exportDataToFile() {
    try {
        const data = localStorage.getItem('iosConfigData');
        if (!data) {
            showToast('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t', false);
            return;
        }
        
        const blob = new Blob([data], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `ios_config_backup_${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showToast('ƒê√£ xu·∫•t d·ªØ li·ªáu th√†nh c√¥ng!', true);
    } catch (error) {
        console.error('L·ªói khi xu·∫•t d·ªØ li·ªáu:', error);
        showToast('L·ªói khi xu·∫•t d·ªØ li·ªáu', false);
    }
}

function importDataFromFile(event) {
    try {
        const file = event.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);
                localStorage.setItem('iosConfigData', JSON.stringify(data));
                loadAllData();
                showToast('ƒê√£ nh·∫≠p d·ªØ li·ªáu th√†nh c√¥ng!', true);
            } catch (error) {
                console.error('L·ªói khi ƒë·ªçc file:', error);
                showToast('File kh√¥ng h·ª£p l·ªá', false);
            }
        };
        reader.readAsText(file);
        
        // Reset input file
        event.target.value = '';
    } catch (error) {
        console.error('L·ªói khi nh·∫≠p d·ªØ li·ªáu:', error);
        showToast('L·ªói khi nh·∫≠p d·ªØ li·ªáu', false);
    }
}

// Auto save khi ng∆∞·ªùi d√πng thay ƒë·ªïi input
function setupAutoSave() {
    const inputs = document.querySelectorAll('input, select, textarea');
    inputs.forEach(input => {
        input.addEventListener('change', function() {
            saveAllData();
        });
        input.addEventListener('input', function() {
            // Debounce ƒë·ªÉ tr√°nh l∆∞u qu√° nhi·ªÅu
            clearTimeout(input._timer);
            input._timer = setTimeout(() => {
                saveAllData();
            }, 1000);
        });
    });
}

// Configuration generation functions
function generateConfig(isPreview) {
    const configName = document.getElementById('configName').value;
    const configDescription = document.getElementById('configDescription').value;
    const organization = document.getElementById('organization').value;
    const identifier = document.getElementById('identifier').value;
    const removalDisallowed = document.getElementById('removalDisallowed').value;
    
    if (!configName || !identifier) {
        showToast('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin c∆° b·∫£n (T√™n c·∫•u h√¨nh v√† ƒê·ªãnh danh)', false);
        return;
    }
    
    let mobileconfig = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>PayloadContent</key>
    <array>`;
    
    const wifiSSID = document.getElementById('wifiSSID').value;
    if (wifiSSID) {
        const wifiSecurity = document.getElementById('wifiSecurity').value;
        const wifiPassword = document.getElementById('wifiPassword').value;
        const wifiAutoJoin = document.getElementById('wifiAutoJoin').value;
        const wifiHidden = document.getElementById('wifiHidden').value;
        
        mobileconfig += `
        <dict>
            <key>PayloadType</key>
            <string>com.apple.wifi.managed</string>
            <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
            <key>PayloadIdentifier</key>
            <string>${identifier}.wifi</string>
            <key>PayloadVersion</key>
            <integer>1</integer>
            <key>PayloadDisplayName</key>
            <string>Wi-Fi (${wifiSSID})</string>
            <key>PayloadDescription</key>
            <string>C·∫•u h√¨nh Wi-Fi</string>
            <key>HIDDEN_NETWORK</key>
            <${wifiHidden}/>
            <key>AutoJoin</key>
            <${wifiAutoJoin}/>
            <key>EncryptionType</key>
            <string>${wifiSecurity}</string>
            <key>SSID_STR</key>
            <string>${wifiSSID}</string>`;
    
        if (wifiPassword && wifiSecurity !== 'None') {
            mobileconfig += `
            <key>Password</key>
            <string>${wifiPassword}</string>`;
        }
        
        mobileconfig += `
        </dict>`;
    }
    
    const dnsServers = document.getElementById('dnsServers').value;
    if (dnsServers) {
        const dnsProxy = document.getElementById('dnsProxy').value;
        const dnsServerList = dnsServers.split('\n').filter(s => s.trim() !== '');
        const dnsSearchDomains = document.getElementById('dnsSearchDomains').value;
        const dnsSearchDomainList = dnsSearchDomains.split('\n').filter(s => s.trim() !== '');
        
        mobileconfig += `
        <dict>
            <key>PayloadType</key>
            <string>com.apple.dnsProxy.managed</string>
            <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
            <key>PayloadIdentifier</key>
            <string>${identifier}.dns</string>
            <key>PayloadVersion</key>
            <integer>1</integer>
            <key>PayloadDisplayName</key>
            <string>C·∫•u h√¨nh DNS</string>
            <key>PayloadDescription</key>
            <string>C·∫•u h√¨nh m√°y ch·ªß DNS</string>
            <key>AppLayerVPN</key>
            <${dnsProxy}/>`;
    
        if (dnsServerList.length > 0) {
            mobileconfig += `
            <key>ServerAddresses</key>
            <array>`;
            dnsServerList.forEach(server => {
                mobileconfig += `
                <string>${server.trim()}</string>`;
            });
            mobileconfig += `
            </array>`;
        }
        
        if (dnsSearchDomainList.length > 0) {
            mobileconfig += `
            <key>SearchDomains</key>
            <array>`;
            dnsSearchDomainList.forEach(domain => {
                mobileconfig += `
                <string>${domain.trim()}</string>`;
            });
            mobileconfig += `
            </array>`;
        }
        
        mobileconfig += `
        </dict>`;
    }
    
    webClips.forEach((webclip, index) => {
        mobileconfig += `
        <dict>
            <key>PayloadType</key>
            <string>com.apple.webClip.managed</string>
            <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
            <key>PayloadIdentifier</key>
            <string>${identifier}.webclip${index + 1}</string>
            <key>PayloadVersion</key>
            <integer>1</integer>
            <key>PayloadDisplayName</key>
            <string>${webclip.name}</string>
            <key>PayloadDescription</key>
            <string>Web Clip</string>
            <key>Label</key>
            <string>${webclip.name}</string>
            <key>URL</key>
            <string>${webclip.url}</string>
            <key>FullScreen</key>
            <${webclip.fullScreen}/>
            <key>Precomposed</key>
            <true/>`;
    
        if (webclip.icon) {
            const base64Data = webclip.icon.split(',')[1];
            mobileconfig += `
            <key>Icon</key>
            <data>${base64Data}</data>`;
        }
        
        mobileconfig += `
        </dict>`;
    });
    
    const apnName = document.getElementById('apnName').value;
    if (apnName) {
        const apnUsername = document.getElementById('apnUsername').value;
        const apnPassword = document.getElementById('apnPassword').value;
        const apnProxy = document.getElementById('apnProxy').value;
        const apnProxyPort = document.getElementById('apnProxyPort').value;
        
        mobileconfig += `
        <dict>
            <key>PayloadType</key>
            <string>com.apple.apn.managed</string>
            <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
            <key>PayloadIdentifier</key>
            <string>${identifier}.apn</string>
            <key>PayloadVersion</key>
            <integer>1</integer>
            <key>PayloadDisplayName</key>
            <string>C·∫•u h√¨nh APN</string>
            <key>PayloadDescription</key>
            <string>C·∫•u h√¨nh m·∫°ng di ƒë·ªông</string>
            <key>apn</key>
            <string>${apnName}</string>`;
    
        if (apnUsername) {
            mobileconfig += `
            <key>username</key>
            <string>${apnUsername}</string>`;
        }
        
        if (apnPassword) {
            mobileconfig += `
            <key>password</key>
            <string>${apnPassword}</string>`;
        }
        
        if (apnProxy) {
            mobileconfig += `
            <key>proxy</key>
            <string>${apnProxy}</string>`;
        }
        
        if (apnProxyPort) {
            mobileconfig += `
            <key>proxyPort</key>
            <integer>${apnProxyPort}</integer>`;
        }
        
        mobileconfig += `
        </dict>`;
    }
    
    const fakeStorageEnabled = document.getElementById('fakeStorageEnabled').value;
    if (fakeStorageEnabled === 'true') {
        const fakeTotalCapacity = document.getElementById('fakeTotalCapacity').value;
        const fakeAvailableCapacity = document.getElementById('fakeAvailableCapacity').value;
        
        if (fakeTotalCapacity && fakeAvailableCapacity) {
            mobileconfig += `
        <dict>
            <key>PayloadType</key>
            <string>com.apple.storagemanagement</string>
            <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
            <key>PayloadIdentifier</key>
            <string>${identifier}.storage</string>
            <key>PayloadVersion</key>
            <integer>1</integer>
            <key>PayloadDisplayName</key>
            <string>Qu·∫£n l√Ω dung l∆∞·ª£ng</string>
            <key>PayloadDescription</key>
            <string>C·∫•u h√¨nh dung l∆∞·ª£ng thi·∫øt b·ªã</string>
            <key>TotalCapacity</key>
            <integer>${parseInt(fakeTotalCapacity) * 1024 * 1024 * 1024}</integer>
            <key>AvailableCapacity</key>
            <integer>${parseInt(fakeAvailableCapacity) * 1024 * 1024 * 1024}</integer>
        </dict>`;
        }
    }
    
    const notificationTitle = document.getElementById('notificationTitle').value;
    const notificationBody = document.getElementById('notificationBody').value;
    if (notificationTitle && notificationBody) {
        const notificationAction = document.getElementById('notificationAction').value;
        const notificationSound = document.getElementById('notificationSound').value;
        
        mobileconfig += `
        <dict>
            <key>PayloadType</key>
            <string>com.apple.notificationsettings</string>
            <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
            <key>PayloadIdentifier</key>
            <string>${identifier}.notification</string>
            <key>PayloadVersion</key>
            <integer>1</integer>
            <key>PayloadDisplayName</key>
            <string>C·∫•u h√¨nh th√¥ng b√°o</string>
            <key>PayloadDescription</key>
            <string>Thi·∫øt l·∫≠p th√¥ng b√°o</string>
            <key>AlertTitle</key>
            <string>${notificationTitle}</string>
            <key>AlertBody</key>
            <string>${notificationBody}</string>`;
    
        if (notificationAction) {
            mobileconfig += `
            <key>AlertAction</key>
            <string>${notificationAction}</string>`;
        }
        
        if (notificationSound) {
            mobileconfig += `
            <key>SoundName</key>
            <string>${notificationSound}</string>`;
        }
        
        mobileconfig += `
        </dict>`;
    }
    
    const customPayloadType = document.getElementById('customPayloadType').value;
    const customPayloadData = document.getElementById('customPayloadData').value;
    if (customPayloadType && customPayloadData) {
        const customPayloadDescription = document.getElementById('customPayloadDescription').value;
        
        mobileconfig += `
        <dict>
            <key>PayloadType</key>
            <string>${customPayloadType}</string>
            <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
            <key>PayloadIdentifier</key>
            <string>${identifier}.custom</string>
            <key>PayloadVersion</key>
            <integer>1</integer>
            <key>PayloadDisplayName</key>
            <string>${customPayloadDescription || 'Payload t√πy ch·ªânh'}</string>
            <key>PayloadDescription</key>
            <string>${customPayloadDescription || 'Payload t√πy ch·ªânh'}</string>
            ${customPayloadData}
        </dict>`;
    }
    
    mobileconfig += `
    </array>
    <key>PayloadDisplayName</key>
    <string>${configName}</string>
    <key>PayloadIdentifier</key>
    <string>${identifier}</string>
    <key>PayloadRemovalDisallowed</key>
    <${removalDisallowed}/>
    <key>PayloadType</key>
    <string>Configuration</string>
    <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
    <key>PayloadVersion</key>
    <integer>1</integer>`;
    
    if (configDescription) {
        mobileconfig += `
    <key>PayloadDescription</key>
    <string>${configDescription}</string>`;
    }
    
    if (organization) {
        mobileconfig += `
    <key>PayloadOrganization</key>
    <string>${organization}</string>`;
    }
    
    mobileconfig += `
</dict>
</plist>`;
    
    if (isPreview) {
        document.getElementById('previewContent').textContent = mobileconfig;
        document.getElementById('previewSection').style.display = 'block';
        document.getElementById('successMessage').style.display = 'none';
    } else {
        document.getElementById('previewContent').textContent = mobileconfig;
        document.getElementById('previewSection').style.display = 'block';
        document.getElementById('successMessage').style.display = 'block';
    }
    saveAllData(); // L∆∞u sau khi t·∫°o c·∫•u h√¨nh
}

function handleDirectInstall() {
    const configContent = document.getElementById('previewContent').textContent;
    const blob = new Blob([configContent], { type: 'application/x-apple-aspen-config' });
    const url = URL.createObjectURL(blob);
    
    const a = document.createElement('a');
    a.href = url;
    
    const configName = document.getElementById('configName').value || 'configuration';
    const cleanFileName = configName.replace(/[^\w\s-]/gi, '').replace(/\s+/g, '_');
    a.download = `${cleanFileName}.mobileconfig`;
    
    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
        window.open(url, '_blank');
        showToast('Tr√™n iOS, vui l√≤ng m·ªü file trong tab m·ªõi v√† l√†m theo h∆∞·ªõng d·∫´n', true);
    } else {
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        showToast(`ƒê√£ t·∫£i file c·∫•u h√¨nh "${cleanFileName}.mobileconfig"`, true);
    }
    
    URL.revokeObjectURL(url);
}

async function createFile() {
    const previewContent = document.getElementById('previewContent').textContent;
    if (!previewContent || previewContent.trim() === '') {
        showToast('Vui l√≤ng t·∫°o c·∫•u h√¨nh tr∆∞·ªõc b·∫±ng n√∫t "T·∫°o C·∫•u H√¨nh"', false);
        return;
    }
    
    const configName = document.getElementById('configName').value || 'configuration';
    const cleanFileName = configName.replace(/[^\w\s-]/gi, '').replace(/\s+/g, '_');
    const mobileconfigContent = previewContent;
    
    const zip = new JSZip();
    
    zip.file(`${cleanFileName}.mobileconfig`, mobileconfigContent);
    
    const readmeContent = `C·∫§U H√åNH iOS - H∆Ø·ªöNG D·∫™N C√ÄI ƒê·∫∂T

T·ªáp n√†y ch·ª©a c·∫•u h√¨nh cho thi·∫øt b·ªã iOS c·ªßa b·∫°n.

H∆Ø·ªöNG D·∫™N C√ÄI ƒê·∫∂T:
1. Gi·∫£i n√©n t·ªáp ZIP n√†y
2. M·ªü t·ªáp ${cleanFileName}.mobileconfig tr√™n thi·∫øt b·ªã iOS
3. L√†m theo h∆∞·ªõng d·∫´n tr√™n m√†n h√¨nh ƒë·ªÉ c√†i ƒë·∫∑t c·∫•u h√¨nh
4. V√†o Settings ‚Üí General ‚Üí VPN & Device Management ƒë·ªÉ x√°c nh·∫≠n c·∫•u h√¨nh ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t

TH√îNG TIN C·∫§U H√åNH:
- T√™n c·∫•u h√¨nh: ${configName}
- T·ªï ch·ª©c: ${document.getElementById('organization').value || 'Kh√¥ng c√≥'}
- M√¥ t·∫£: ${document.getElementById('configDescription').value || 'Kh√¥ng c√≥'}

T·∫°o b·ªüi: ùôÉùôè ùôÑùôäùôé·ØìDev`;
    
    zip.file("README.txt", readmeContent);
    
    const zipBlob = await zip.generateAsync({type: "blob"});
    const zipUrl = URL.createObjectURL(zipBlob);
    
    const a = document.createElement('a');
    a.href = zipUrl;
    a.download = `${cleanFileName}_iOS_Configuration.zip`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(zipUrl);
    
    showToast(`ƒê√£ t·∫°o file ZIP "${cleanFileName}_iOS_Configuration.zip" th√†nh c√¥ng!`, true);
}

// Menu functions
function toggleMenu() {
    const menuPanel = document.getElementById('menuPanel');
    if (menuPanel) {
        menuPanel.classList.toggle('open');
    }
}

function switchToTab(tabId) {
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-tab') === tabId) {
            tab.classList.add('active');
        }
    });
    
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.getElementById(`${tabId}-tab`).classList.add('active');
    
    toggleMenu();
    showToast(`ƒê√£ chuy·ªÉn ƒë·∫øn tab ${tabId === 'basic' ? 'Th√¥ng Tin C∆° B·∫£n' : tabId === 'webclip' ? 'Web Clip' : tabId === 'wifi' ? 'Wi-Fi' : tabId === 'dns' ? 'DNS' : 'N√¢ng Cao'}`, true);
}

function quickGenerateConfig() {
    document.getElementById('configName').value = 'C·∫•u h√¨nh iOS - ' + new Date().toLocaleDateString('vi-VN');
    document.getElementById('identifier').value = 'com.htios.' + Date.now();
    document.getElementById('removalDisallowed').value = 'false';
    
    generateConfig(false);
    showToast('ƒê√£ t·∫°o c·∫•u h√¨nh nhanh v·ªõi gi√° tr·ªã m·∫∑c ƒë·ªãnh!', true);
    toggleMenu();
}

function resetForm() {
    if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën ƒë·∫∑t l·∫°i t·∫•t c·∫£ c√°c tr∆∞·ªùng v·ªÅ gi√° tr·ªã m·∫∑c ƒë·ªãnh?')) {
        document.getElementById('configForm').reset();
        webClips = [];
        document.getElementById('multipleWebclipsList').innerHTML = `
            <div class="empty-state" id="webclipEmptyState" style="text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.6);">
                <i class="fas fa-inbox" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
                <p style="margin: 0 0 8px 0; font-size: 1.1em;">Ch∆∞a c√≥ web clip n√†o ƒë∆∞·ª£c t·∫°o</p>
                <small style="font-size: 0.9em;">H√£y th√™m web clip t·ª´ c√°c ph·∫ßn b√™n tr√™n</small>
            </div>
        `;
        updateWebclipsCount();
        document.getElementById('previewSection').style.display = 'none';
        showToast('ƒê√£ ƒë·∫∑t l·∫°i t·∫•t c·∫£ c√°c tr∆∞·ªùng v·ªÅ gi√° tr·ªã m·∫∑c ƒë·ªãnh!', true);
        toggleMenu();
        saveAllData(); // L∆∞u sau khi reset
    }
}

document.addEventListener('DOMContentLoaded', function() {
    updateWebclipsCount();
    
    // T·ª± ƒë·ªông t·∫£i d·ªØ li·ªáu khi trang ƒë∆∞·ª£c t·∫£i
    loadAllData();
    setupAutoSave();
    
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');
            
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            this.classList.add('active');
            document.getElementById(`${tabId}-tab`).classList.add('active');
        });
    });
    
    const advancedTabs = document.querySelectorAll('.advanced-tab');
    advancedTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-advanced-tab');
            
            document.querySelectorAll('.advanced-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.advanced-tab-content').forEach(c => c.classList.remove('active'));
            
            this.classList.add('active');
            document.getElementById(`${tabId}-tab`).classList.add('active');
        });
    });
    
    const generateMultipleBtn = document.getElementById('generateMultipleWebclipsBtn');
    if (generateMultipleBtn) {
        generateMultipleBtn.addEventListener('click', generateMultipleWebclips);
    }
    
    const webclipIconFile = document.getElementById('webclipIconFile');
    if (webclipIconFile) {
        webclipIconFile.addEventListener('change', function(e) {
            handleIconFileSelect(e, 'webclipIconFileName');
        });
    }
    
    const generateBtn = document.getElementById('generateBtn');
    if (generateBtn) {
        generateBtn.addEventListener('click', function() {
            generateConfig(false);
        });
    }
    
    const closePreviewBtn = document.getElementById('closePreviewBtn');
    if (closePreviewBtn) {
        closePreviewBtn.addEventListener('click', function() {
            const previewSection = document.getElementById('previewSection');
            if (previewSection) {
                previewSection.style.display = 'none';
            }
        });
    }
    
    const installBtn = document.getElementById('installBtn');
    if (installBtn) {
        installBtn.addEventListener('click', handleDirectInstall);
    }
    
    const createBtn = document.getElementById('createBtn');
    if (createBtn) {
        createBtn.addEventListener('click', createFile);
    }
    
    const addSingleWebclipBtn = document.getElementById('addSingleWebclipBtn');
    if (addSingleWebclipBtn) {
        addSingleWebclipBtn.addEventListener('click', addSingleWebclip);
    }
    
    const clearAllWebclipsBtn = document.getElementById('clearAllWebclipsBtn');
    if (clearAllWebclipsBtn) {
        clearAllWebclipsBtn.addEventListener('click', clearAllWebclips);
    }
    
    const singleWebclipIconFile = document.getElementById('singleWebclipIconFile');
    if (singleWebclipIconFile) {
        singleWebclipIconFile.addEventListener('change', function(e) {
            handleSingleIconFileSelect(e, 'singleWebclipIconFileName');
        });
    }
    
    const musicBtn = document.getElementById('musicBtn');
    if (musicBtn) {
        musicBtn.addEventListener('click', toggleMusic);
    }
    
    // Menu functionality
    const menuBtn = document.getElementById('menuBtn');
    const menuPanel = document.getElementById('menuPanel');
    const menuItems = document.querySelectorAll('.menu-item');
    const quickGenerateBtn = document.getElementById('quickGenerateBtn');
    const exportConfigBtn = document.getElementById('exportConfigBtn');
    const importConfigBtn = document.getElementById('importConfigBtn');
    const saveDataBtn = document.getElementById('saveDataBtn');
    const loadDataBtn = document.getElementById('loadDataBtn');
    const resetFormBtn = document.getElementById('resetFormBtn');
    
    if (menuBtn) {
        menuBtn.addEventListener('click', function() {
            playSound(clickSound);
            toggleMenu();
        });
    }
    
    menuItems.forEach(item => {
        const tabId = item.getAttribute('data-tab');
        if (tabId) {
            item.addEventListener('click', function() {
                playSound(clickSound);
                switchToTab(tabId);
            });
        }
    });
    
    if (quickGenerateBtn) {
        quickGenerateBtn.addEventListener('click', function() {
            playSound(clickSound);
            quickGenerateConfig();
        });
    }
    
    if (exportConfigBtn) {
        exportConfigBtn.addEventListener('click', function() {
            playSound(clickSound);
            createFile();
            toggleMenu();
        });
    }
    
    if (saveDataBtn) {
        saveDataBtn.addEventListener('click', function() {
            playSound(clickSound);
            if (saveAllData()) {
                showToast('ƒê√£ l∆∞u t·∫•t c·∫£ d·ªØ li·ªáu th√†nh c√¥ng!', true);
            }
            toggleMenu();
        });
    }
    
    if (loadDataBtn) {
        loadDataBtn.addEventListener('click', function() {
            playSound(clickSound);
            loadAllData();
            toggleMenu();
        });
    }
    
    if (resetFormBtn) {
        resetFormBtn.addEventListener('click', function() {
            playSound(clickSound);
            resetForm();
        });
    }
    
    // Th√™m file input ·∫©n cho import data
    const importFileInput = document.createElement('input');
    importFileInput.type = 'file';
    importFileInput.accept = '.json';
    importFileInput.style.display = 'none';
    importFileInput.addEventListener('change', importDataFromFile);
    document.body.appendChild(importFileInput);
    
    if (importConfigBtn) {
        importConfigBtn.addEventListener('click', function() {
            playSound(clickSound);
            importFileInput.click();
            toggleMenu();
        });
    }
    
    const settingsBtn = document.getElementById('settingsBtn');
    const customizationPanel = document.getElementById('customizationPanel');
    const togglePanel = document.getElementById('togglePanel');
    const bgOptions = document.querySelectorAll('.bg-option');
    const colorOptions = document.querySelectorAll('.color-option');
    const customBgUpload = document.getElementById('customBgUpload');

    initCustomization();
    
    if (settingsBtn) {
        settingsBtn.addEventListener('click', function() {
            playSound(clickSound);
            customizationPanel.classList.toggle('open');
        });
    }
    
    if (togglePanel) {
        togglePanel.addEventListener('click', function() {
            playSound(clickSound);
            customizationPanel.classList.toggle('open');
        });
    }
    
    bgOptions.forEach(option => {
        option.addEventListener('click', function() {
            playSound(clickSound);
            
            bgOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            
            const bgUrl = this.getAttribute('data-bg');
            document.body.style.backgroundImage = `url('${bgUrl}')`;
            localStorage.setItem('backgroundImage', bgUrl);
            localStorage.removeItem('customBackgroundImage');
            document.getElementById('customBgFileName').textContent = 'Ch∆∞a ch·ªçn ·∫£nh';
            showToast('ƒê√£ thay ƒë·ªïi ·∫£nh n·ªÅn!', true);
            saveAllData();
        });
    });
    
    if (customBgUpload) {
        customBgUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const base64 = e.target.result;
                    document.body.style.backgroundImage = `url('${base64}')`;
                    localStorage.setItem('customBackgroundImage', base64);
                    localStorage.removeItem('backgroundImage');
                    
                    bgOptions.forEach(option => {
                        option.classList.remove('active');
                    });
                    
                    document.getElementById('customBgFileName').textContent = file.name;
                    showToast('ƒê√£ ƒë·∫∑t ·∫£nh n·ªÅn t√πy ch·ªânh!', true);
                    saveAllData();
                };
                reader.readAsDataURL(file);
            }
        });
    }
    
    colorOptions.forEach(option => {
        option.addEventListener('click', function() {
            playSound(clickSound);
            
            colorOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            
            const theme = this.getAttribute('data-theme');
            localStorage.setItem('theme', theme);
            setThemeGradient(theme);
            
            showToast(`ƒê√£ ƒë·ªïi sang ch·ªß ƒë·ªÅ ${theme}!`, true);
            saveAllData();
        });
    });

    // L∆∞u d·ªØ li·ªáu khi ng∆∞·ªùi d√πng r·ªùi trang
    window.addEventListener('beforeunload', function() {
        saveAllData();
    });
});
    </script>
</body>
</html>
